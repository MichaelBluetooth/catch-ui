<div *ngIf="issue">
  <h3>{{issue.issue_title}}</h3>
  <h5>{{issue.project.projectname}}</h5>

  <div class="d-flex justify-content-between align-items-center d-print-none">
    <div class="d-flex align-items-center">
      <div class="btn-group me-2 mt-2">
        <button class="btn btn-secondary" (click)="edit()"><i class='bx bx-edit'></i> Edit</button>
      </div>
      <div class="btn-group me-2 mt-2">
        <button class="btn btn-secondary" (click)="focusCommentField()"><i class='bx bx-comment'></i>
          Comment</button>
      </div>
      <app-workflow-btn class="m2-2 mt-2" [issue]="issue"></app-workflow-btn>
    </div>
    <div>
      <button class="btn btn-secondary me-2 mt-2" (click)="print()"><i class='bx bx-printer'></i></button>
      <button class="btn btn-secondary me-2 mt-2"><i class='bx bx-share'></i></button>
    </div>
  </div>

  <div class="properties-container mt-4">
    <div class="row">
      <div class="col-md-8">
        <app-collapsible-section [collapsed]="false">
          <div class="collapsible-section-header fw-bold">Details</div>
          <div class="collapsible-section-content">
            <app-issue-details-section [issue]="issue"></app-issue-details-section>
          </div>
        </app-collapsible-section>

        <br>

        <app-collapsible-section [collapsed]="false" class="mt-4">
          <div class="collapsible-section-header fw-bold">Description</div>
          <div class="collapsible-section-content">
            <div class="mb-4" style="white-space: pre-wrap;">
              {{issue.description}}
            </div>
            <!-- <textarea readonly class="form-control mt-2" rows="4">{{issue.description}}</textarea> -->
          </div>
        </app-collapsible-section>

        <br>

        <app-collapsible-section class="mt-4" [collapsed]="false">
          <div class="collapsible-section-header fw-bold">Comments</div>
          <div class="collapsible-section-content">
            <app-issue-comments [issue]="issue"></app-issue-comments>
          </div>
        </app-collapsible-section>

        <div class="mt-4">
          <button *ngIf="!showComment" class="btn btn-secondary" (click)="toggleComment()">
            <i class='bx bx-comment'></i> Comment
          </button>

          <ng-container *ngIf="showComment">
            <textarea #commentField class="form-control" [(ngModel)]="comment" rows="5"></textarea>
            <input #imageField type="file" class="form-control mt-2">
            <div class="mt-2">
              <button class="btn btn-secondary me-2" (click)="submitComment()">
                Submit
              </button>
              <button class="btn btn-link" (click)="toggleComment()">
                Cancel
              </button>
            </div>
          </ng-container>
        </div>
      </div>
      <div class="col-md-4">

        <app-collapsible-section [collapsed]="false">
          <div class="collapsible-section-header fw-bold">People</div>
          <div class="collapsible-section-content">
            <app-issue-people-section [issue]="issue"></app-issue-people-section>
          </div>
        </app-collapsible-section>

        <br>

        <app-collapsible-section [collapsed]="false" class="mt-4">
          <div class="collapsible-section-header fw-bold">Dates</div>
          <div class="collapsible-section-content">
            <app-issue-dates-section [issue]="issue"></app-issue-dates-section>
          </div>
        </app-collapsible-section>
      </div>
    </div>
  </div>
</div>
